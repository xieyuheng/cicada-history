<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2018-09-21 Fri 23:07 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>1-3 Formulating Abstractions with Higher-Order Procedures</title>
<meta name="generator" content="Org-mode" />
<link rel="stylesheet" href="css/org-page.css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">1-3 Formulating Abstractions with Higher-Order Procedures</h1>
<div id="table-of-contents">
<h2>overview</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org98cf4d4">1-3-1 Procedures as Arguments</a></li>
<li><a href="#orgdd2544b">Exercise 1.29 &#x2013; Simpson's Rule for numerical integration</a></li>
<li><a href="#org5227c47">Exercise 1.30 &#x2013; sum-iter</a></li>
<li><a href="#orgb9e9f23">Exercise 1.31 &#x2013; Wallis Product</a></li>
<li><a href="#orgb008aca">Exercise 1.32 &#x2013; accumulate</a></li>
<li><a href="#org237c42f">Exercise 1.33 &#x2013; filtered-accumulate</a></li>
<li><a href="#org765dd5d">1-3-2 Constructing Procedures Using Lambda</a></li>
<li><a href="#org188efc2">1-3-3 Procedures as General Methods</a>
<ul>
<li><a href="#orgaa18c96">Finding roots of equations by the half-interval method</a></li>
<li><a href="#org789774e"><span class="todo _todo_">[todo]</span> Finding fixed points of functions</a></li>
</ul>
</li>
<li><a href="#orgefc347c">1-3-4 Procedures as Returned Values</a></li>
</ul>
</div>
</div>

<div id="outline-container-org98cf4d4" class="outline-2">
<h2 id="org98cf4d4">1-3-1 Procedures as Arguments</h2>
<div class="outline-text-2" id="text-org98cf4d4">
<div class="org-src-container">

<pre class="src src-jojo">(<span style="color: #DFAF8F;">=</span> (sum-integers a b)
   (<span style="color: #F0DFAF; font-weight: bold;">if</span> (gt a b)
     0
     (add a (sum-integers (add a 1) b))))

(<span style="color: #F0DFAF; font-weight: bold;">assert</span> (eq 5050 (sum-integers 0 100)))

(cube x) <span style="color: #DFAF8F;">=</span> (mul x (mul x x))

(<span style="color: #DFAF8F;">=</span> (sum-cubes a b)
   (<span style="color: #F0DFAF; font-weight: bold;">if</span> (gt a b)
     0
     (add (cube a)
          (sum-cubes (add a 1) b))))

(<span style="color: #F0DFAF; font-weight: bold;">assert</span> (eq (sum-cubes 0 3)
            (add (cube 1)
                 (add (cube 2)
                      (cube 3)))))

(<span style="color: #DFAF8F;">=</span> (pi-sum a b)
   (<span style="color: #F0DFAF; font-weight: bold;">if</span> (gt a b)
     0
     (add (div 1 (mul a (add a 2)))
          (pi-sum (add a 4) b))))

(<span style="color: #DFAF8F;">=</span> pi 3.1415926)

(<span style="color: #F0DFAF; font-weight: bold;">assert</span> (lt (abs (sub pi
                      (mul 8 (pi-sum 1 10000))))
            0.001))

(<span style="color: #DFAF8F;">=</span> assert-delta
   (<span style="color: #F0DFAF; font-weight: bold;">macro</span> [body]
     (<span style="color: #DFAF8F;">=</span> delta (car body))
     (<span style="color: #DFAF8F;">=</span> a (car (cdr body)))
     (<span style="color: #DFAF8F;">=</span> b (car (cdr (cdr body))))
     `(<span style="color: #F0DFAF; font-weight: bold;">assert</span> (lt (abs (sub ~a ~b)) ~delta))))

(<span style="color: #F0DFAF; font-weight: bold;">assert-delta</span> 0.001
  (mul 8 (pi-sum 1 10000)) pi)

(<span style="color: #DFAF8F;">=</span> (sum term a next b)
   (<span style="color: #F0DFAF; font-weight: bold;">if</span> (gt a b)
     0
     (add (term a)
          (sum term (next a) next b))))

(<span style="color: #DFAF8F;">=</span> (sum-cubes a b)
   (sum cube a inc b))

(<span style="color: #F0DFAF; font-weight: bold;">assert</span> (eq (sum-cubes 0 3)
            (add (cube 1)
                 (add (cube 2)
                      (cube 3)))))

(<span style="color: #F0DFAF; font-weight: bold;">assert</span> (eq (sum-cubes 1 10)
            3025))

(<span style="color: #DFAF8F;">=</span> (identity x) x)

(<span style="color: #DFAF8F;">=</span> (sum-integers a b)
   (sum identity a inc b))

(<span style="color: #F0DFAF; font-weight: bold;">assert</span> (eq 5050 (sum-integers 0 100)))

(<span style="color: #DFAF8F;">=</span> (pi-sum a b)
   (<span style="color: #DFAF8F;">=</span> (pi-term x) (div 1 (mul x (add x 2))))
   (<span style="color: #DFAF8F;">=</span> (pi-next x) (add x 4))
   (sum pi-term a pi-next b))


(<span style="color: #F0DFAF; font-weight: bold;">assert-delta</span> 0.001
  pi (mul 8 (pi-sum 1 10000)))

(<span style="color: #DFAF8F;">=</span> (integral f a b dx)
   (<span style="color: #DFAF8F;">=</span> (add-dx x) (add x dx))
   (mul (sum f (add a (div dx 2)) add-dx b)
        dx))

(<span style="color: #F0DFAF; font-weight: bold;">assert-delta</span> 0.001
  (integral cube 0 1 0.001)
  (div 1 4))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdd2544b" class="outline-2">
<h2 id="orgdd2544b">Exercise 1.29 &#x2013; Simpson's Rule for numerical integration</h2>
<div class="outline-text-2" id="text-orgdd2544b">
<div class="org-src-container">

<pre class="src src-jojo">(<span style="color: #DFAF8F;">=</span> (simpson-integral f a b n)
   (<span style="color: #DFAF8F;">=</span> h (div (sub b a) n))
   (<span style="color: #DFAF8F;">=</span> (simpson-coefficient k)
      (<span style="color: #F0DFAF; font-weight: bold;">cond</span> [(or (eq 0 k) (eq n k)) 1]
            [(odd-p k) 4]
            [(even-p k) 2]))
   (<span style="color: #DFAF8F;">=</span> (simpson-term k)
      (mul (simpson-coefficient k)
           (f (add a (mul k h)))))
   (mul (sum simpson-term 0 inc n)
        (div h 3)))

(<span style="color: #F0DFAF; font-weight: bold;">assert-delta</span> 0.0001
  (simpson-integral cube 0 1 100)
  (div 1 4))
</pre>
</div>
</div>
</div>

<div id="outline-container-org5227c47" class="outline-2">
<h2 id="org5227c47">Exercise 1.30 &#x2013; sum-iter</h2>
<div class="outline-text-2" id="text-org5227c47">
<div class="org-src-container">

<pre class="src src-jojo">(<span style="color: #F0DFAF; font-weight: bold;">note</span> we do not have letrec
  (<span style="color: #DFAF8F;">=</span> (sum term a next b)
     (<span style="color: #DFAF8F;">=</span> (iter a result)
        (<span style="color: #F0DFAF; font-weight: bold;">if</span> (gt a b)
          result
          (iter (next a) (add (term a) result))))
     (iter a 0)))

(<span style="color: #DFAF8F;">=</span> (sum-iter term a next b result)
   (<span style="color: #F0DFAF; font-weight: bold;">if</span> (gt a b)
     result
     (sum-iter term (next a) next b (add (term a) result))))

(<span style="color: #DFAF8F;">=</span> (sum term a next b)
   (sum-iter term a next b 0))

(<span style="color: #DFAF8F;">=</span> (sum-cubes a b)
   (sum cube a inc b))

(<span style="color: #F0DFAF; font-weight: bold;">assert</span> (eq (sum-cubes 0 3)
            (add (cube 1)
                 (add (cube 2)
                      (cube 3)))))

(<span style="color: #F0DFAF; font-weight: bold;">assert</span> (eq (sum-cubes 1 10)
            3025))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb9e9f23" class="outline-2">
<h2 id="orgb9e9f23">Exercise 1.31 &#x2013; Wallis Product</h2>
<div class="outline-text-2" id="text-orgb9e9f23">
<div class="org-src-container">

<pre class="src src-jojo">(<span style="color: #DFAF8F;">=</span> (product term a next b)
   (<span style="color: #F0DFAF; font-weight: bold;">if</span> (gt a b)
     1
     (mul (term a)
          (product term (next a) next b))))

(<span style="color: #DFAF8F;">=</span> (wallis-product a b)
   (<span style="color: #DFAF8F;">=</span> (wallis-term x)
      (div (mul (add (mul 2 x) 0) (add (mul 2 x) 2))
           (mul (add (mul 2 x) 1) (add (mul 2 x) 1))))
   (product wallis-term a inc b))

(<span style="color: #F0DFAF; font-weight: bold;">assert-delta</span> 0.001
  (wallis-product 1 1000)
  (div pi 4))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb008aca" class="outline-2">
<h2 id="orgb008aca">Exercise 1.32 &#x2013; accumulate</h2>
<div class="outline-text-2" id="text-orgb008aca">
<div class="org-src-container">

<pre class="src src-jojo">(<span style="color: #DFAF8F;">=</span> (accumulate combiner null-value
               term a next b)
   (<span style="color: #F0DFAF; font-weight: bold;">if</span> (gt a b)
     null-value
     (combiner (term a)
               (accumulate combiner null-value
                           term (next a) next b))))

(<span style="color: #DFAF8F;">=</span> (sum term a next b)
   (accumulate add 0 term a next b))

(<span style="color: #DFAF8F;">=</span> (product term a next b)
   (accumulate mul 1 term a next b))

(<span style="color: #DFAF8F;">=</span> (pi-sum a b)
   (<span style="color: #DFAF8F;">=</span> (pi-term x) (div 1 (mul x (add x 2))))
   (<span style="color: #DFAF8F;">=</span> (pi-next x) (add x 4))
   (sum pi-term a pi-next b))

(<span style="color: #F0DFAF; font-weight: bold;">assert-delta</span> 0.001
  pi
  (mul 8 (pi-sum 1 10000)))

(<span style="color: #DFAF8F;">=</span> (wallis-product a b)
   (<span style="color: #DFAF8F;">=</span> (wallis-term x)
      (div (mul (add (mul 2 x) 0) (add (mul 2 x) 2))
           (mul (add (mul 2 x) 1) (add (mul 2 x) 1))))
   (product wallis-term a inc b))

(<span style="color: #F0DFAF; font-weight: bold;">assert-delta</span> 0.001
  (wallis-product 1 1000)
  (div pi 4))
</pre>
</div>
</div>
</div>

<div id="outline-container-org237c42f" class="outline-2">
<h2 id="org237c42f">Exercise 1.33 &#x2013; filtered-accumulate</h2>
<div class="outline-text-2" id="text-org237c42f">
<div class="org-src-container">

<pre class="src src-jojo">(<span style="color: #DFAF8F;">=</span> (filtered-accumulate
    combiner null-value
    term a next b
    filter)
   (<span style="color: #F0DFAF; font-weight: bold;">if</span> (gt a b)
     null-value
     (<span style="color: #F0DFAF; font-weight: bold;">if</span> (filter a)
       (combiner (term a)
                 (filtered-accumulate
                  combiner null-value
                  term (next a) next b
                  filter))
       (filtered-accumulate
        combiner null-value
        term (next a) next b
        filter))))

(<span style="color: #DFAF8F;">=</span> section-1-2
   (<span style="color: #F0DFAF; font-weight: bold;">load</span> <span style="color: #CC9393;">"1-2-procedures-and-the-processes-they-generate.jo"</span>))

(<span style="color: #DFAF8F;">=</span> prime-p section-1-2.prime-p)

(<span style="color: #DFAF8F;">=</span> (sum-prime-square a b)
   (filtered-accumulate
    add 0
    identity a inc b
    prime-p))

(<span style="color: #F0DFAF; font-weight: bold;">assert</span> (eq (sum-prime-square 0 10)
            (add 1 (add 2 (add 3 (add 5 7))))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org765dd5d" class="outline-2">
<h2 id="org765dd5d">1-3-2 Constructing Procedures Using Lambda</h2>
<div class="outline-text-2" id="text-org765dd5d">
<div class="org-src-container">

<pre class="src src-jojo">(<span style="color: #DFAF8F;">=</span> (pi-sum a b)
   (sum (<span style="color: #F0DFAF; font-weight: bold;">lambda</span> [x] (div 1 (mul x (add x 2))))
        a
        (<span style="color: #F0DFAF; font-weight: bold;">lambda</span> [x] (add x 4))
        b))

(<span style="color: #F0DFAF; font-weight: bold;">assert-delta</span> 0.001
  pi (mul 8 (pi-sum 1 10000)))

(<span style="color: #DFAF8F;">=</span> (integral f a b dx)
   (mul (sum f (add a (div dx 2))
             (<span style="color: #F0DFAF; font-weight: bold;">lambda</span> [x] (add x dx))
             b)
        dx))

(<span style="color: #F0DFAF; font-weight: bold;">assert-delta</span> 0.001
  (integral cube 0 1 0.001)
  (div 1 4))
</pre>
</div>
</div>
</div>

<div id="outline-container-org188efc2" class="outline-2">
<h2 id="org188efc2">1-3-3 Procedures as General Methods</h2>
<div class="outline-text-2" id="text-org188efc2">
</div><div id="outline-container-orgaa18c96" class="outline-3">
<h3 id="orgaa18c96">Finding roots of equations by the half-interval method</h3>
<div class="outline-text-3" id="text-orgaa18c96">
<div class="org-src-container">

<pre class="src src-jojo">(<span style="color: #DFAF8F;">=</span> (average x y) (div (add x y) 2))

(<span style="color: #DFAF8F;">=</span> (positive-p x) (gt x 0))
(<span style="color: #DFAF8F;">=</span> (negative-p x) (lt x 0))

(<span style="color: #DFAF8F;">=</span> (search f neg-point pos-point)
   (<span style="color: #DFAF8F;">=</span> midpoint (average neg-point pos-point))
   (<span style="color: #F0DFAF; font-weight: bold;">if</span> (close-enough-p neg-point pos-point)
     midpoint
     (<span style="color: #F0DFAF; font-weight: bold;">let</span> [(test-value (f midpoint))]
       (<span style="color: #F0DFAF; font-weight: bold;">cond</span>
         [(positive-p test-value)
          (search f neg-point midpoint)]
         [(negative-p test-value)
          (search f midpoint pos-point)]
         [<span style="color: #7CB8BB;">else</span> midpoint]))))

(<span style="color: #DFAF8F;">=</span> (close-enough-p x y)
   (lt (abs (sub x y)) 0.001))

(<span style="color: #DFAF8F;">=</span> (half-interval-method f a b)
   (<span style="color: #F0DFAF; font-weight: bold;">let</span> [(a-value (f a))
         (b-value (f b))]
     (<span style="color: #F0DFAF; font-weight: bold;">cond</span> [(and (negative-p a-value)
                 (positive-p b-value))
            (search f a b)]
           [(and (negative-p b-value)
                 (positive-p a-value))
            (search f b a)]
           [<span style="color: #7CB8BB;">else</span>
            (println <span style="color: #CC9393;">"- half-interval-method"</span>)
            (println <span style="color: #CC9393;">"  values are not of opposite sign"</span>)
            (print <span style="color: #CC9393;">"  a : "</span>) (println a)
            (print <span style="color: #CC9393;">"  b : "</span>) (println b)])))

(<span style="color: #F0DFAF; font-weight: bold;">assert-delta</span> 0.01
  (half-interval-method num-sin 2 4)
  3.14)

(<span style="color: #F0DFAF; font-weight: bold;">assert-delta</span> 0.01
  (half-interval-method
   (<span style="color: #F0DFAF; font-weight: bold;">lambda</span> [x] (mul (sub x 1) (sub x 3)))
   0
   2)
  1)
</pre>
</div>
</div>
</div>

<div id="outline-container-org789774e" class="outline-3">
<h3 id="org789774e"><span class="todo _todo_">[todo]</span> Finding fixed points of functions</h3>
<div class="outline-text-3" id="text-org789774e">
<div class="org-src-container">

<pre class="src src-jojo">(<span style="color: #DFAF8F;">=</span> tolerance 0.00001)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgefc347c" class="outline-2">
<h2 id="orgefc347c">1-3-4 Procedures as Returned Values</h2>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2018-09-21 Fri 23:07</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
